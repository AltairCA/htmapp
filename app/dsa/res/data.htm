<?global

#include "cpp/index_thread.h"

?><?c

	t_pb8 pb;
	pb[ "map" ] = tq::get( "indexer.out", "." );
	pb[ "drive" ] = tq::get( "indexer.job.drive", "." );
	pb[ "drive" ][ "progress" ] = tq::get( "indexer.progress", "." ).ToInt64();
		
	// Send back indexer status
	out << parser::EncodeJson< str::t_char8, str::t_string8, t_pb8 >( pb ).c_str();

	// Set the center folder
	tq::set( "indexer.center", in[ "GET" ][ "center" ].str(), "." );

	// Request another update from the indexer thread
	tq::set( "indexer.update", 1, "." );
	
	return 0;
?>
